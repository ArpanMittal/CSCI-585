SELECT temp_result1.Maker, temp_result1.Commentor
FROM
(SELECT result.Maker, result.Commentor, SUM(result.Num_Comments) as Number_Comments
FROM 
(SELECT post_temp.Maker,post_temp.POST_ID, comment_temp.Commentor, COUNT(comment_temp.COMMENT_ID) as Num_Comments FROM
(SELECT fir.USER_ID as FIR, second.USER_ID as SECOND
FROM USERS fir, USERS second
WHERE fir.USER_ID != second.USER_ID)temp
JOIN
(SELECT POST_ID, USER_ID as Maker 
 FROM POSTS) post_temp 
 ON temp.FIR =  post_temp.Maker
 JOIN
(SELECT COMMENT_ID, POST_ID, USER_ID as Commentor
 FROM COMMENTS)comment_temp
 ON post_temp.POST_ID = comment_temp.POST_ID 
 WHERE comment_temp.Commentor = temp.SECOND
 GROUP BY post_temp.Maker,post_temp.POST_ID, comment_temp.Commentor
 
 ORDER BY post_temp.Maker, Commentor)result
 JOIN USERS creater 
 ON creater.USER_ID = result.Maker 
 JOIN USERS comm 
 ON result.Commentor = comm.USER_ID
 WHERE  creater.GENDER != comm.GENDER
 GROUP BY  result.Maker,result.Commentor
 HAVING SUM(result.Num_Comments)>=5)temp_result1,
 (SELECT result.Maker, result.Commentor, SUM(result.Num_Comments) as Number_Comments
FROM 
(SELECT post_temp.Maker,post_temp.POST_ID, comment_temp.Commentor, COUNT(comment_temp.COMMENT_ID) as Num_Comments FROM
(SELECT fir.USER_ID as FIR, second.USER_ID as SECOND
FROM USERS fir, USERS second
WHERE fir.USER_ID != second.USER_ID)temp
JOIN
(SELECT POST_ID, USER_ID as Maker 
 FROM POSTS) post_temp 
 ON temp.FIR =  post_temp.Maker
 JOIN
(SELECT COMMENT_ID, POST_ID, USER_ID as Commentor
 FROM COMMENTS)comment_temp
 ON post_temp.POST_ID = comment_temp.POST_ID 
 WHERE comment_temp.Commentor = temp.SECOND
 GROUP BY post_temp.Maker,post_temp.POST_ID, comment_temp.Commentor
 
 ORDER BY post_temp.Maker, Commentor)result
 JOIN USERS creater 
 ON creater.USER_ID = result.Maker 
 JOIN USERS comm 
 ON result.Commentor = comm.USER_ID
 WHERE  creater.GENDER != comm.GENDER
 GROUP BY  result.Maker,result.Commentor
 HAVING SUM(result.Num_Comments)>=5)temp_result2
 WHERE 
 ((temp_result1.Maker = temp_result2.Commentor) AND (temp_result1.Commentor=temp_result2.Maker))
 AND temp_result1.Commentor > temp_result1.Maker
 LIMIT 10;
 
 